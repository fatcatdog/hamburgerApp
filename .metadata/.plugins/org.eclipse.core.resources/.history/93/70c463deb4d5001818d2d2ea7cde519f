package com.jacob.controller;

import org.springframework.beans.factory.annotation.Autowired;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.PostMapping;
import org.springframework.web.bind.annotation.RequestParam;
import org.springframework.web.multipart.MultipartFile;
import org.springframework.web.servlet.ModelAndView;

import com.jacob.service.PictureService;
import com.jacob.service.S3ServicesInterface;
 
@Controller
public class UploadFileController {
	
	@Autowired
	S3ServicesInterface s3Services;
	
	@Autowired
	PictureService pictureService;
	
//	@RequestParam("keyname") String keyName,
	
    @PostMapping("/food/upload")
    public ModelAndView uploadMultipartFile( @RequestParam("preuploadPicFile") MultipartFile file,  @RequestParam("picName") String picname,  @RequestParam("picDescription") String description, @RequestParam("picBrand") String brand) {
		String keyName = pictureService.generateKeynameForPic(file);
		
		
		
    	s3Services.uploadFile(keyName, file);
//		return "Upload Successfully. -> KeyName = " + keyName;
    	
		  return new ModelAndView("redirect:/home");
 
		
    }    
}